<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <title>Ponuka pízz</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>

<div th:replace="fragments/navbar :: navbar('pizza')"></div>

<div class="container">
    <h1>Ponuka pízz</h1>

    <form th:action="@{/pizza}" method="get" class="filter-bar">

        <!-- SEARCH -->
        <input type="text"
               name="q"
               placeholder="Hľadať pizzu..."
               th:value="${q}">

        <!-- TAG FILTER -->
        <select name="tagId">
            <option value="">Všetky tagy</option>
            <option th:each="tag : ${tags}"
                    th:value="${tag.id}"
                    th:text="${tag.name}"
                    th:selected="${tag.id == tagId}">
            </option>
        </select>

        <button type="submit" class="btn-primary">Filtrovať</button>
    </form>

    <div class="pizza-grid">

        <div class="pizza-card" th:each="pizza : ${pizzas}">
            <img th:src="${pizza.imageUrl}" alt="Pizza obrázok">

            <h3 th:text="${pizza.name}">Názov pizze</h3>
            <p th:text="${pizza.description}">Popis pizze</p>
            
            <a th:href="@{|/pizza/${pizza.slug}|}" class="btn-primary">
                Detail
            </a>

            <div class="price-section">

                <div class="size-row" th:each="size : ${pizza.sizes}">
                    <strong th:text="${size.sizeLabel}">M</strong>:
                    <span th:text="${size.price + ' €'}"></span>

                    <form th:action="@{/cart/add}" method="post" style="display:inline;">
                        <input type="hidden" name="pizzaId" th:value="${pizza.id}">
                        <input type="hidden" name="sizeId" th:value="${size.id}">
                        <input type="hidden" name="redirect" th:value="${redirect}">
                        <button type="submit" class="add-cart-btn">Pridať</button>
                    </form>
                </div>
            </div>

        </div>

    </div>

</div>

<footer>
    © 2025 Pizzeria — všetky práva vyhradené
</footer>

</body>
</html>
